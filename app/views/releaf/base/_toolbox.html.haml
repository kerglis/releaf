:ruby
  # Normaly we get list_url as local variable
  # If not defined, we get list_url from params
  if local_assigns.fetch(:list_url, nil).nil?
    list_url = params[:list_url]

    if list_url.nil? && params[:action] == "index"
      list_url = request.path
      real_params = params.except(:action, :controller, :ajax)
      unless real_params.empty?
        list_url += "?#{real_params.to_query}"
      end
    end
  end

.toolbox
  %button.button.trigger.only-icon{:type => 'button', :title => t('Tools', :scope => 'admin.global')}
    %i.fa.fa-lg.fa-cog
  %menu.block.toolbox-items{:type => 'toolbar'}
    %i.fa.fa-lg.fa-caret-up
    %ul.block
      = render 'toolbox.items', :resource => resource, :list_url => list_url
